<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>M√≥n ƒÉn y√™u th√≠ch</title>
    <link rel="stylesheet" href="food.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>
<body>
<h1>üíñ Danh s√°ch m√≥n ƒÉn y√™u th√≠ch</h1>
<div class="favorite-foods-list"></div>

<script>
    $(document).ready(function () {
        loadFavoriteFoods();
    });

    function loadFavoriteFoods() {
        let favoriteFoods = JSON.parse(localStorage.getItem("favoriteFoods")) || [];

        if (favoriteFoods.length === 0) {
            $(".favorite-foods-list").html("<p>Ch∆∞a c√≥ m√≥n ƒÉn n√†o trong danh s√°ch y√™u th√≠ch.</p>");
            return;
        }

        $(".favorite-foods-list").empty();

        favoriteFoods.forEach(foodId => {
            $.ajax({
                url: `http://localhost:8080/api/foods/${foodId}`,
                type: "GET",
                dataType: "json",
                success: function (food) {
                    let foodItem = `
                            <div class="food-item">
                                <img src="${food.imageUrl}" alt="${food.name}">
                                <h2>${food.name}</h2>
                                <p>Gi√°: ${formatCurrency(food.price)}</p>
                                <button class="remove-favorite" data-id="${foodId}">‚ùå X√≥a</button>
                            </div>
                        `;
                    $(".favorite-foods-list").append(foodItem);
                },
                error: function () {
                    console.error("L·ªói khi t·∫£i th√¥ng tin m√≥n ƒÉn:", foodId);
                }
            });
        });

        $(document).on("click", ".remove-favorite", function () {
            let foodId = $(this).data("id");
            removeFromFavorites(foodId);
        });
    }

    function removeFromFavorites(foodId) {
        let favoriteFoods = JSON.parse(localStorage.getItem("favoriteFoods")) || [];
        favoriteFoods = favoriteFoods.filter(id => id !== foodId);
        localStorage.setItem("favoriteFoods", JSON.stringify(favoriteFoods));
        loadFavoriteFoods();
    }

    function formatCurrency(amount) {
        return new Intl.NumberFormat('vi-VN', { style: 'currency', currency: 'VND' }).format(amount);
    }
</script>
</body>
</html>
